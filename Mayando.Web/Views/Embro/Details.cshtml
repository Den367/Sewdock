@using System.Web.Mvc.Html
@using Mayando.Web.Extensions
@using Mayando.Web.Infrastructure
@using Mayando.Web.Properties

@model Mayando.Web.ViewModels.EmbroDetailsViewModel
@{Layout = null;}

<h2>@{
    if (null != Model)
    {
        var embro = Model.Embro;
        if (embro != null && embro.DisplayTitle != null)
        {
            Html.Encode(Model.Embro.DisplayTitle);
        }
    }
}</h2>

<style>
    ins > div[id="@Model.Id"]
    {
     background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='100%' height='100%'><linearGradient id='gradient'><stop offset='20%' stop-color='%23999'/><stop offset='90%' stop-color='%23ccc'/></linearGradient><rect fill='url(%23gradient)' style='stroke:rgb(80,90,100);stroke-width:7;fill-opacity:0.1;stroke-opacity:0.9' x='0' y='0' width='100%' height='100%'/></svg>");
    }
    </style>
<div id="embrocontainer">
    @{Html.RenderPartial(PartialViewName.DetailsDesign, Model); }
    <div>
        @Html.Raw(Html.ActionLink(Resources.EmbroDownloadButtonText, ActionName.Download, "embro", new { @id = Model.Id }, new { @class = "btn" }))
        @if (User.Identity.IsAuthenticated)
            {
                var user = (Membership.GetUser());
                if (User.IsAdministrator() || (user != null && ((Guid) ((user.ProviderUserKey) ?? Guid.NewGuid()) == Model.Embro.UserID)))
                {
                    @Ajax.ActionLink(@Resources.EmbroDeleteButtonText,"ConfirmDelete",new {id = Model.Id, returnUrl = Request.Url.AbsoluteUri}, new AjaxOptions
                 {
                     UpdateTargetId = "embro-delete-view",
                     InsertionMode = InsertionMode.Replace,
                     HttpMethod                   = "POST",
                     Url = Url.Action("ConfirmDelete", "Embro", new { @id = Model.Id })
                      
                 })   
                }

            }
        
        <div id="embro-delete-view"></div>
    </div>

    @*@if (!Model.HidePhotoText) 
    @*@
    @{ 
        Html.RenderPartial(PartialViewName.DetailsText, Model); 
    }
</div>
<div id="commentscontainer">
    @{ Html.RenderAction("Index", "Comment", new { count = 5, page = 1, embroID = Model.Id }); }
</div>
